@if (VisibleText.IsNotEmpty())
{
    <span class=@ContainerClass style=@ContainerStyle>
        @if (ShowBadge)
        {
            <RadzenBadge  Text=@VisibleText
                         BadgeStyle="BadgeStyle.Secondary"
                         Variant="Variant.Outlined"
                         title=@TooltipText />
        }
        else
        {
            <span class="date-display__text" title=@TooltipText>
                @if (Caption)
                {
                    <span class="rz-text-caption">@VisibleText</span>
                }
                else if (ShowStatus)
                {
                    <strong>@VisibleText</strong>
                }
                else
                {
                    @VisibleText
                }
            </span>
        }

        @if (ShowStatus)
        {
            <BadgetAutoColor Value=@DateStatus />
        }
    </span>
}

@code {
    [Parameter] public DateTime? Value { get; set; }
    [Parameter] public bool ShowBadge { get; set; }
    [Parameter] public bool ShowStatus { get; set; }
    [Parameter] public bool Caption { get; set; }
    [Parameter] public string Class { get; set; } = "";
    [Parameter] public string FontSize { get; set; } = "0.875rem";

    private string VisibleText { get; set; } = "";
    private string TooltipText { get; set; } = "";
    private string DateStatus { get; set; } = "";

    private string ContainerClass => string.IsNullOrEmpty(Class)
        ? "date-display"
        : $"date-display {Class}";

    private string ContainerStyle => $"font-size: {FontSize};";

    protected override void OnParametersSet()
    {
        if (!Value.HasValue)
        {
            ResetState();
            return;
        }

        var date = Value.Value;
        VisibleText = RegionService.ToLocalFriendlyDate(date);
        TooltipText = date.ToString("g");

        if (ShowStatus)
        {
            VisibleText = VisibleText
                .ReplaceIgnoreCase("Hoy", "")
                .ReplaceIgnoreCase("Ayer", "")
                .ReplaceIgnoreCase("Mañana", "")
                .Trim();
        }

        DateStatus = GetDateStatus(date);
    }

    private void ResetState()
    {
        VisibleText = "";
        TooltipText = "";
        DateStatus = "";
    }

    private string GetDateStatus(DateTime date)
    {
        var today = DateTime.Today;

        return date.Date switch
        {
            _ when date.Date == today => "Hoy",
            _ when date.Date == today.AddDays(1) => "Mañana",
            _ when date.Date == today.AddDays(-1) => "Ayer",
            _ when date.Date < today => "Pasado",
            _ => "Futuro"
        };
    }
}

<style>
    .date-display {
        display: inline-flex;
        align-items: center;
        gap: 0.375rem;
        white-space: nowrap;
        line-height: 1.4;
    }

    .date-display__text {
        display: inline-block;
    }
</style>